# 5장

※ 여러개의 서버에 데이터를 균등하게 나누는 보편적인 방법 **해시**

- **해시**
    - 임의의 길이의 데이터 ⇒ 고정된 길이의 데이터로 변환
    - **특징**
        - 단방향성: 해시값으로부터 원본 데이터를 역산하는 것은 매우 어렵다.
        - 빠른 연산 속도: 해시 함수는 입력 데이터의 길이에 상관없이 일정한 시간 내에 해시값을 생성할 수 있다.
        - **균일성**: **서로 다른 입력 데이터는 서로 다른 해시값을 생성**
        - 충돌 회피: 서로 다른 입력 데이터가 동일한 해시값을 생성하는 경우를 최소화해야 한다.
    

```
serverIndex = hash(key) % N (N: 서버의 수)
```

% 모듈러 연산을 통한 해시 서버 분배는 간편하지만, 

서버 장애등의 이유로 서버가 변경되면, 엉떵한 서버를 가리키는 대규모 캐시 미스(cache miss)가 발생한다.

### 안정 해시

- 서버에 균등하게(k/n)개의 키만을 배치하는 해시 기술.
- **해시링**
    - 서버와 키를 균등 분포

- 문제점
    - 파티션 크기를 균등하게 유지하는게 불가능
    - 서버의 변경이 일어날 때, 키의 균등 분포 어려움

- **가상노드**
    - 하나의 서버는 링 위에서 여러 개의 가상 노드를 가짐
    - 가상 노드의 개수를 늘리면 키의 분포가 점점 균등해짐
        - 표준 편차가 작아져서 데이터가 고르게 분포되기 때문

### **생각해 볼 것들**

- 서버가 추가되거나 삭제될 때 올바르게 키를 분배하도록 주의
- 해시링을 활용해 데이터를 균등 분포하여 수평적 확장에 도움을 준다
- **핫스팟 키**
    - 사용자들이 특히 많이 사용하는 데이터 키값
    - 키의 갯수 만을 균등하게 분포하는 것이 아닌, 핫스팟 키에 대한 대처도 필요함